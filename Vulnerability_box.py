#!/usr/bin/env python
#coding: utf-8
#Date: 20170722
#Author: 1975

import urllib2
from bs4 import BeautifulSoup

class wWord(object):
    def __init__(self):
        self.host = 'https://book.thief.one/'

    def http_req(self, url):
        request = urllib2.Request(url)
        res = urllib2.urlopen(request, timeout=7)
        data = res.read()
        return data
        
    def rtitle(self, data):
        rtitle = []
        soup = BeautifulSoup(data, 'html.parser', from_encoding='utf-8')
        vul_list = soup.find_all('li', class_='chapter')
        for single in vul_list:
            v_name = single.find_all('a')
            tmp = []
            tmp.append(v_name[0].get_text().strip())
            tmp.append(v_name[0]['href'])
            rtitle.append(tmp)
        return rtitle

    def saveHtml(self):
        llist = self.rtitle(self.http_req(self.host))
        for n in llist:
            try:
                url = self.host + n[1]
                filename = n[1].split('/')[1]
                if filename is not None and '-' in filename:
                    with open(filename, 'a') as f:
                        f.write(self.http_req(url))
                else:
                    continue
            except:
                pass

if __name__ == '__main__':
    w = wWord()
    w.saveHtml()